<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>新增維修單 - 維修工單管理系統</title>
    <link rel="stylesheet" href="/static/css/main.css">
    <link rel="stylesheet" href="/static/css/form.css">
</head>
<body>
    <div class="container">
        <nav class="navbar">
            <div class="nav-brand">
                <h1>🔧 維修工單管理系統</h1>
            </div>
            <div class="nav-links">
                <a href="/maintenance/new" class="nav-link active">新增工單</a>
                <a href="/maintenance/list" class="nav-link">工單列表</a>
                <a href="/maintenance/workers" class="nav-link">工務人員</a>
            </div>
        </nav>

        <main class="main-content">
            <div class="page-header">
                <h2>📝 新增維修單</h2>
                <p>填寫維修單資訊，所有欄位皆為選填</p>
            </div>

            <form id="workOrderForm" class="work-order-form" enctype="multipart/form-data">
                <div class="form-section">
                    <h3>📋 基本資訊</h3>
                    
                    <div class="form-group">
                        <label for="workOrderNumber">維修單號</label>
                        <input type="text" id="workOrderNumber" class="form-control" readonly 
                               placeholder="系統自動產生">
                    </div>

                    <div class="form-group">
                        <label for="date">日期</label>
                        <input type="date" id="date" name="date" class="form-control">
                    </div>

                    <div class="form-group">
                        <label for="siteName">案場</label>
                        <input type="text" id="siteName" name="siteName" class="form-control" 
                               placeholder="輸入案場名稱" list="recentSites">
                        <datalist id="recentSites"></datalist>
                    </div>
                </div>

                <div class="form-section">
                    <h3>📍 位置資訊</h3>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="building">棟別</label>
                            <input type="text" id="building" name="building" class="form-control" 
                                   placeholder="如：A棟">
                        </div>
                        
                        <div class="form-group">
                            <label for="floor">樓層</label>
                            <input type="text" id="floor" name="floor" class="form-control" 
                                   placeholder="如：3F">
                        </div>
                        
                        <div class="form-group">
                            <label for="unit">戶別</label>
                            <input type="text" id="unit" name="unit" class="form-control" 
                                   placeholder="如：301">
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>🔧 維修資訊</h3>
                    
                    <div class="form-group">
                        <label for="reason">維修原因</label>
                        <textarea id="reason" name="reason" class="form-control" rows="3" 
                                  placeholder="描述需要維修的問題"></textarea>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="workerName">工務人員</label>
                            <input type="text" id="workerName" name="workerName" class="form-control" 
                                   placeholder="負責人員姓名" list="workersList">
                            <datalist id="workersList"></datalist>
                        </div>
                        
                        <div class="form-group">
                            <label for="amount">金額 (NT$)</label>
                            <input type="number" id="amount" name="amount" class="form-control" 
                                   min="0" step="1" placeholder="維修費用">
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>📷 照片上傳</h3>
                    
                    <div class="form-group">
                        <label for="photos">上傳照片 (最多10張)</label>
                        <div class="file-upload-area" id="fileUploadArea">
                            <input type="file" id="photos" name="photos" multiple accept="image/*" 
                                   class="file-input">
                            <div class="file-upload-text">
                                <span class="upload-icon">📁</span>
                                <p>點擊或拖拽圖片到此處上傳</p>
                                <small>支援 JPG, PNG, GIF 格式，每張最大 10MB</small>
                            </div>
                        </div>
                        <div id="photoPreview" class="photo-preview"></div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="resetForm()">
                        🔄 重置
                    </button>
                    <button type="submit" class="btn btn-primary">
                        ✅ 建立維修單
                    </button>
                </div>
            </form>

            <div id="successModal" class="modal">
                <div class="modal-content">
                    <h3>✅ 維修單建立成功！</h3>
                    <div id="successDetails"></div>
                    <div class="modal-actions">
                        <button class="btn btn-primary" onclick="window.location.reload()">
                            建立新工單
                        </button>
                        <button class="btn btn-secondary" onclick="window.location.href='/maintenance/list'">
                            查看工單列表
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="/static/js/utils.js"></script>
    <script src="/static/js/new-work-order.js"></script>
</body>
</html>